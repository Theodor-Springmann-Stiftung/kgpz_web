{{ $model := .model }}

<!-- Sequential page layout for piece view -->

	<div class="space-y-8 h-full relative" id="piece-content">
		{{ if $model.Images.AllPages }}
			<!-- Two-column newspaper layout -->
			<div class="grid grid-cols-2 gap-4">
				{{ range $pageIndex, $page := $model.Images.AllPages }}
					{{ $pageEntry := index $model.AllPages $pageIndex }}
					{{- $issueKey := printf "%d-%d" $pageEntry.IssueYear $pageEntry.IssueNumber -}}
					{{- $issueData := GetIssue $issueKey -}}
					{{- $issueContext := "" -}}
					{{- if $issueData -}}
						{{- $issueContext = printf "%d.%d.%d Nr. %d" $issueData.Datum.When.Day $issueData.Datum.When.Month $issueData.Datum.When.Year $pageEntry.IssueNumber -}}
					{{- else -}}
						{{- $issueContext = printf "%d Nr. %d" $pageEntry.IssueYear $pageEntry.IssueNumber -}}
					{{- end -}}

					<!-- Page container -->
					<div class="piece-page-container newspaper-page-container" id="piece-page-{{ $page.PageNumber }}" data-page-container="{{ $page.PageNumber }}" data-page-icon-type="{{ $page.PageIcon }}">
						<!-- Page indicator row -->
						<div class="flex justify-start items-center gap-2 mb-3">
							<span class="part-number bg-slate-100 text-slate-800 text-sm font-bold px-1.5 py-0.5 rounded border border-slate-400 flex items-center justify-center">
								{{ $pageEntry.PartNumber }}. Teil
							</span>
							<span class="page-indicator text-sm font-bold text-slate-600 bg-blue-50 px-2 py-1 rounded transition-all duration-300 flex items-center gap-1 relative" data-page="{{ $page.PageNumber }}">
								{{ $issueContext }}, {{ $page.PageNumber }}
								{{ template "_page_link_indicator" (dict "pageNumber" $page.PageNumber "targetPage" $.targetPage) }}
							</span>

							<!-- Action buttons -->
							{{ template "_page_action_buttons" (dict "PageNumber" $page.PageNumber "IsBeilage" false "PartNumber" $pageEntry.PartNumber "ImageElement" (printf "#piece-page-%d .piece-page-image" $page.PageNumber) "ButtonSize" "small" "ShowZoom" true) }}
						</div>

						<!-- Page image -->
						<div class="single-page bg-white p-4 rounded border border-slate-200 hover:border-slate-300 transition-colors duration-200">
							{{ if $page.Available }}
								<img src="{{ $page.ImagePath }}"
									 alt="Seite {{ $page.PageNumber }} ({{ $issueContext }})"
									 class="piece-page-image newspaper-page-image cursor-zoom-in rounded-sm hover:scale-[1.02] transition-transform duration-200 w-full"
									 onclick="enlargePage(this, {{ $page.PageNumber }}, false, {{ $pageEntry.PartNumber }})"
									 data-page="{{ $page.PageNumber }}"
									 loading="lazy" />
							{{ else }}
								<div class="bg-slate-100 border border-slate-200 rounded p-8 text-center">
									<i class="ri-image-line text-4xl text-slate-400 mb-2 block"></i>
									<p class="text-slate-500">Bild nicht verf端gbar</p>
								</div>
							{{ end }}
						</div>

					</div>
				{{ end }}
			</div>
		{{ else }}
			<!-- No pages available -->
			<div class="text-center text-slate-500 py-16">
				<i class="ri-file-list-line text-6xl mb-4 block"></i>
				<h3 class="text-xl font-semibold mb-2">Keine Seiten verf端gbar</h3>
				<p>F端r diesen Beitrag sind derzeit keine Seitenbilder verf端gbar.</p>
			</div>
		{{ end }}
	</div>

	<!-- Modal for enlarged view -->
	{{ template "_page_modal" }}